<!DOCTYPE html>
<html lang="en">
<head>
    <meta charset="UTF-8">
    <title>Live Stream Player</title>
    <link rel="icon" href="https://i.ibb.co/N9WPySH/photo-2024-04-02-12-55-10.jpg" type="image/x-icon">
    <meta http-equiv="X-UA-Compatible" content="IE=edge">
    <meta name="description" content="Live streaming with DRM support">
    <link rel="stylesheet" href="https://cdnjs.cloudflare.com/ajax/libs/font-awesome/4.7.0/css/font-awesome.min.css">
    <meta name="viewport" content="width=device-width, initial-scale=1.0">
    <script src="https://cdnjs.cloudflare.com/ajax/libs/shaka-player/3.0.0/shaka-player.compiled.js"></script>
    <style>
        body {
            margin: 0;
            padding: 0;
            background: #000;
            font-family: "Roboto", sans-serif;
            display: flex;
        }

        #left-panel {
            width: 250px;
            padding: 10px;
            background: #1e1e1e;
            color: #fff;
            box-sizing: border-box;
        }

        #player-container {
            flex-grow: 1;
            padding: 10px;
        }

        .block, .button-area-line a, select, input[type="text"], button {
            display: block;
            margin: 10px 0;
        }

        .button-area-line a, button {
            background: #069994;
            color: #fff;
            padding: 10px;
            text-align: center;
            border: none;
            cursor: pointer;
        }

        .button-area-line a:hover, button:hover {
            background: #047a6e;
        }

        select, input[type="text"] {
            width: 100%;
            padding: 8px;
            border: 1px solid #ccc;
            border-radius: 4px;
        }

        .separator {
            margin: 10px 0;
            border-top: 1px solid #333;
        }

        .player-title {
            color: #fff;
            text-align: center;
            margin: 10px 0;
        }
    </style>
</head>
<body>
    <div id="left-panel">
        <input type="text" id="m3u8-input" placeholder=".m3u8 link here">
        <button id="play-direct-m3u8">Play Direct .m3u8</button>

        <div class="separator"></div>

        <input type="text" id="m3u-url-input" placeholder="M3U URL here">
        <button id="load-m3u-url">Load M3U from URL</button>

        <div class="separator"></div>

        <input type="file" id="file-input" accept=".m3u">
        <button id="load-channels">Load Channels</button>

        <div class="separator"></div>

        <div>
            <label for="group-select">Group:</label>
            <select id="group-select"></select>
        </div>

        <div>
            <label for="channel-select">Channel:</label>
            <select id="channel-select"></select>
        </div>
    </div>

    <div id="player-container">
        <div class="player-title" id="player-title">Select a channel to play</div>
        <video id="video" width="100%" height="100%" controls></video>
    </div>

    <script>
        document.addEventListener('DOMContentLoaded', function() {
            var player = new shaka.Player(document.getElementById('video'));

            // Function to handle .m3u8 input
            document.getElementById('play-direct-m3u8').addEventListener('click', function() {
                var url = document.getElementById('m3u8-input').value;
                if (url) {
                    player.load(url).then(function() {
                        document.getElementById('player-title').textContent = 'Playing: ' + url;
                    }).catch(function(error) {
                        console.error('Error loading video:', error);
                    });
                }
            });

            // Function to handle M3U URL input
            document.getElementById('load-m3u-url').addEventListener('click', function() {
                var url = document.getElementById('m3u-url-input').value;
                if (url) {
                    fetch(url)
                        .then(response => response.text())
                        .then(data => {
                            var lines = data.split('\n');
                            var groups = new Set();
                            var channels = [];

                            lines.forEach(line => {
                                if (line.startsWith('#EXTINF:')) {
                                    var parts = line.split(',');
                                    var channel = parts[1] || 'Unknown';
                                    channels.push(channel);
                                } else if (line.startsWith('#EXTGRP:')) {
                                    groups.add(line.split(':')[1]);
                                }
                            });

                            var groupSelect = document.getElementById('group-select');
                            var channelSelect = document.getElementById('channel-select');

                            groupSelect.innerHTML = '<option value="">Select Group</option>';
                            channelSelect.innerHTML = '<option value="">Select Channel</option>';

                            groups.forEach(group => {
                                var option = document.createElement('option');
                                option.value = group;
                                option.textContent = group;
                                groupSelect.appendChild(option);
                            });

                            channels.forEach(channel => {
                                var option = document.createElement('option');
                                option.value = channel;
                                option.textContent = channel;
                                channelSelect.appendChild(option);
                            });
                        }).catch(error => {
                            console.error('Error loading M3U file:', error);
                        });
            });

            // Function to handle file input
            document.getElementById('file-input').addEventListener('change', function(event) {
                var file = event.target.files[0];
                if (file) {
                    var reader = new FileReader();
                    reader.onload = function(e) {
                        var text = e.target.result;
                        var lines = text.split('\n');
                        var groups = new Set();
                        var channels = [];

                        lines.forEach(line => {
                            if (line.startsWith('#EXTINF:')) {
                                var parts = line.split(',');
                                var channel = parts[1] || 'Unknown';
                                channels.push(channel);
                            } else if (line.startsWith('#EXTGRP:')) {
                                groups.add(line.split(':')[1]);
                            }
                        });

                        var groupSelect = document.getElementById('group-select');
                        var channelSelect = document.getElementById('channel-select');

                        groupSelect.innerHTML = '<option value="">Select Group</option>';
                        channelSelect.innerHTML = '<option value="">Select Channel</option>';

                        groups.forEach(group => {
                            var option = document.createElement('option');
                            option.value = group;
                            option.textContent = group;
                            groupSelect.appendChild(option);
                        });

                        channels.forEach(channel => {
                            var option = document.createElement('option');
                            option.value = channel;
                            option.textContent = channel;
                            channelSelect.appendChild(option);
                        });
                    };
                    reader.readAsText(file);
                }
            });

            // Function to handle group and channel selection
            document.getElementById('group-select').addEventListener('change', function() {
                var group = this.value;
                // Filter channels based on selected group if necessary
            });

            document.getElementById('channel-select').addEventListener('change', function() {
                var channel = this.value;
                // Handle channel selection
                var url = 'https://example.com/path/to/your/playlist.m3u8'; // Replace with actual URL if needed
                player.load(url).then(function() {
                    document.getElementById('player-title').textContent = 'Playing: ' + channel;
                }).catch(function(error) {
                    console.error('Error loading video:', error);
                });
            });
        });
    </script>
</body>
</html>
